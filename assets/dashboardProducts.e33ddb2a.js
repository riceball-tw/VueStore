import{q as M,m as b,d as A,r as D,o as a,l as H,w as I,b as t,y as Q,h as j,c as i,B as u,C as p,f as Z,F as g,g as P,u as L,D as B,z as S,t as f,a as E,$ as V}from"./index.036f5c0f.js";import{_ as W}from"./DashboardDeleteModal.68ed95c3.js";import{_ as z}from"./AppPagination.41ad211d.js";const N={class:"modal-box w-full max-w-none p-8"},O={class:"text-3xl font-bold mb-8"},T=["onSubmit"],G={class:"flex gap-4 flex-col max-w-[300px]"},J=["src"],K={key:1,for:"imageUpload",class:"text-sm flex flex-col items-center justify-center p-8 bg-base-300 rounded-lg cursor-pointer"},R=t("svg",{class:"mb-2",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",height:"48",width:"48"},[t("path",{d:"M9 42q-1.2 0-2.1-.9Q6 40.2 6 39V9q0-1.2.9-2.1Q7.8 6 9 6h30q1.2 0 2.1.9.9.9.9 2.1v30q0 1.2-.9 2.1-.9.9-2.1.9Zm0-3h30V9H9v30Zm2.8-4.85h24.45l-7.35-9.8-6.6 8.55-4.65-6.35ZM9 39V9v30Z"})],-1),X={class:"tracking-widest"},Y={key:0},tt={key:1},et={class:"form-control w-full"},lt=t("label",{for:"imageUrl",class:"label"},[t("span",{class:"label-text"},"\u5716\u7247\u9023\u7D50")],-1),st={class:"flex gap-2"},ot=["disabled"],nt=t("svg",{fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",height:"24",width:"24"},[t("path",{d:"M6.4 19 5 17.6l5.6-5.6L5 6.4 6.4 5l5.6 5.6L17.6 5 19 6.4 13.4 12l5.6 5.6-1.4 1.4-5.6-5.6Z"})],-1),at=[nt],it={class:"form-control w-full hidden"},rt=t("hr",{class:"divider border-none"},null,-1),dt=["src"],ut=["for"],ct=t("svg",{class:"mb-2",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",height:"48",width:"48"},[t("path",{d:"M9 42q-1.2 0-2.1-.9Q6 40.2 6 39V9q0-1.2.9-2.1Q7.8 6 9 6h30q1.2 0 2.1.9.9.9.9 2.1v30q0 1.2-.9 2.1-.9.9-2.1.9Zm0-3h30V9H9v30Zm2.8-4.85h24.45l-7.35-9.8-6.6 8.55-4.65-6.35ZM9 39V9v30Z"})],-1),pt={class:"tracking-widest"},ht={key:0},mt={key:1},_t={class:"form-control w-full"},ft=t("label",{for:"imageUrl",class:"label"},[t("span",{class:"label-text"},"\u5716\u7247\u9023\u7D50")],-1),bt={class:"flex gap-2"},vt=["onUpdate:modelValue","disabled"],gt=["onClick"],wt=t("svg",{fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",height:"24",width:"24"},[t("path",{d:"M6.4 19 5 17.6l5.6-5.6L5 6.4 6.4 5l5.6 5.6L17.6 5 19 6.4 13.4 12l5.6 5.6-1.4 1.4-5.6-5.6Z"})],-1),xt=[wt],yt=["onClick"],Ut=t("svg",{fill:"currentColor",title:"Trash Can \u5783\u573E\u6876",xmlns:"http://www.w3.org/2000/svg",height:"24",width:"24"},[t("path",{d:"M7 21q-.825 0-1.412-.587Q5 19.825 5 19V6H4V4h5V3h6v1h5v2h-1v13q0 .825-.587 1.413Q17.825 21 17 21ZM17 6H7v13h10ZM9 17h2V8H9Zm4 0h2V8h-2ZM7 6v13Z"})],-1),$t=[Ut],kt={class:"form-control w-full hidden"},Ct=t("label",{for:"imageUpload",class:"label"},[t("span",{class:"label-text"},"\u6216\u4E0A\u50B3\u65B0\u5716\u7247")],-1),Vt=["id","onChange"],Mt=["disabled"],qt={class:"flex gap-4 flex-col w-full"},Zt={class:"form-control w-full"},Ft=t("label",{for:"title",class:"label"},[t("span",{class:"label-text"},"\u6A19\u984C")],-1),Pt={class:"flex gap-4 flex-wrap md:flex-nowrap"},At={class:"form-control w-full"},Dt=t("label",{for:"category",class:"label"},[t("span",{class:"label-text"},"\u5206\u985E")],-1),Ht={class:"form-control w-full"},It=t("label",{for:"unit",class:"label"},[t("span",{class:"label-text"},"\u7522\u54C1\u55AE\u4F4D")],-1),Qt={class:"flex gap-4 flex-wrap md:flex-nowrap"},jt={class:"form-control w-full"},Lt=t("label",{for:"originalPrice",class:"label"},[t("span",{class:"label-text"},"\u539F\u50F9")],-1),Bt={class:"input-group"},St=t("span",null,"\u5143",-1),Et={class:"form-control w-full"},Wt=t("label",{for:"price",class:"label"},[t("span",{class:"label-text"},"\u552E\u50F9")],-1),zt={class:"input-group"},Nt=t("span",null,"\u5143",-1),Ot={class:"form-control w-full"},Tt=t("label",{for:"description",class:"label"},[t("span",{class:"label-text"},"\u7522\u54C1\u63CF\u8FF0")],-1),Gt={class:"form-control w-full"},Jt=t("label",{for:"content",class:"label"},[t("span",{class:"label-text"},"\u8AAA\u660E\u5167\u5BB9")],-1),Kt={class:"form-control w-full"},Rt={for:"isEnabled",class:"label"},Xt=t("span",{class:"label-text"},"\u662F\u5426\u555F\u7528",-1),Yt={class:"modal-action flex flex-wrap gap-4"},te=t("button",{class:"btn btn-primary btn-wide",type:"submit",form:"productForm"},"\u78BA\u8A8D",-1),ee=["onClick"],le={inheritAttrs:!1},F=Object.assign(le,{__name:"ProductModal",props:{product:{type:Object,default(){return{is_enabled:0}}}},emits:["confirm","cancel"],setup(q,{emit:m}){const w=q,_=M("axiosWithAuth"),e=b({...w.product}),d=b(!1),h=b([]),x=A(()=>{if(!e.value.imagesUrl)return!0;const s=e.value.imagesUrl.length-1;if(s===-1)return!0;const l=e.value.imagesUrl[s];return Boolean(l)});function y(){const s={...e.value};m("confirm",s)}function U(s){e.value.imagesUrl.splice(s,1)}function $(){e.value.imagesUrl||(e.value.imagesUrl=[""])}function k(s){const l=new FormData;l.append("file-to-upload",s),d.value=!0,_({method:"post",url:"/admin/upload",data:l}).then(o=>{e.value.imageUrl=o.data.imageUrl}).finally(()=>{d.value=!1})}function C(s,l){const o=new FormData;o.append("file-to-upload",s),h.value.push(l),_({method:"post",url:"/admin/upload",data:o}).then(c=>{e.value.imagesUrl[l]=c.data.imageUrl}).finally(()=>{h.value=h.value.filter(c=>c!==l)})}return(s,l)=>{const o=D("vue-final-modal");return a(),H(o,S(s.$attrs,{classes:"flex justify-center items-center"}),{default:I(({close:c})=>[t("div",N,[t("div",O,[Q(s.$slots,"title")]),t("form",{id:"productForm",class:"mb-8 flex flex-col md:flex-row gap-8",onSubmit:j(()=>{c(),y()},["prevent"])},[t("div",G,[e.value.imageUrl?(a(),i("img",{key:0,src:e.value.imageUrl},null,8,J)):(a(),i("label",K,[R,t("span",X,[d.value?(a(),i("span",tt,"\u5716\u7247\u4E0A\u50B3\u4E2D\u2026\u2026")):(a(),i("span",Y,"\u8ACB\u4E0A\u50B3\u9996\u9801\u5716\u7247"))])])),t("div",et,[lt,t("div",st,[u(t("input",{id:"imageUrl","onUpdate:modelValue":l[0]||(l[0]=n=>e.value.imageUrl=n),disabled:d.value,class:"input input-bordered w-full",type:"text",placeholder:"\u8ACB\u8F38\u5165\u5716\u7247\u9023\u7D50\u2026\u2026"},null,8,ot),[[p,e.value.imageUrl]]),e.value.imageUrl?(a(),i("button",{key:0,type:"button",class:"btn btn-outline btn-square",onClick:l[1]||(l[1]=()=>{e.value.imageUrl=""})},at)):Z("",!0)])]),t("div",it,[t("input",{id:"imageUpload",name:"imageFile",class:"file-input input-bordered w-full",type:"file",onChange:l[2]||(l[2]=n=>{k(n.target.files[0])})},null,32)]),rt,(a(!0),i(g,null,P(e.value.imagesUrl,(n,r)=>(a(),i(g,{key:`imagesUrl-${r}`},[e.value.imagesUrl[r]?(a(),i("img",{key:0,src:e.value.imagesUrl[r]},null,8,dt)):(a(),i("label",{key:1,for:`imagesUrl-${r}`,class:"text-sm flex flex-col items-center justify-center p-8 bg-base-300 rounded-lg cursor-pointer"},[ct,t("span",pt,[h.value.includes(r)?(a(),i("span",mt,"\u5716\u7247\u4E0A\u50B3\u4E2D\u2026\u2026")):(a(),i("span",ht,"\u8ACB\u4E0A\u50B3\u9996\u9801\u5716\u7247"))])],8,ut)),t("div",_t,[ft,t("div",bt,[u(t("input",{"onUpdate:modelValue":v=>e.value.imagesUrl[r]=v,class:"input input-bordered w-full",type:"text",disabled:h.value.includes(r),placeholder:"\u8ACB\u8F38\u5165\u5716\u7247\u9023\u7D50\u2026\u2026"},null,8,vt),[[p,e.value.imagesUrl[r]]]),e.value.imagesUrl[r]?(a(),i("button",{key:0,type:"button",class:"btn btn-outline btn-square",onClick:()=>{e.value.imagesUrl[r]=""}},xt,8,gt)):Z("",!0),t("button",{type:"button",class:"btn btn-outline btn-square hover:btn-error",onClick:v=>U(r)},$t,8,yt)])]),t("div",kt,[Ct,t("input",{id:`imagesUrl-${r}`,name:"imageFile",class:"file-input input-bordered w-full",type:"file",onChange:v=>{C(v.target.files[0],r)}},null,40,Vt)])],64))),128)),t("button",{type:"button",disabled:!L(x),class:"btn btn-full btn-outline",onClick:$}," \u65B0\u589E\u5716\u7247 ",8,Mt)]),t("div",qt,[t("div",Zt,[Ft,u(t("input",{id:"title","onUpdate:modelValue":l[3]||(l[3]=n=>e.value.title=n),class:"input input-bordered w-full",type:"text",placeholder:"\u8ACB\u8F38\u5165\u6A19\u984C\u2026\u2026",required:""},null,512),[[p,e.value.title]])]),t("div",null,[t("div",Pt,[t("div",At,[Dt,u(t("input",{id:"category","onUpdate:modelValue":l[4]||(l[4]=n=>e.value.category=n),class:"input input-bordered w-full",type:"text",placeholder:"\u8ACB\u8F38\u5165\u5206\u985E\u2026\u2026",required:""},null,512),[[p,e.value.category]])]),t("div",Ht,[It,u(t("input",{id:"unit","onUpdate:modelValue":l[5]||(l[5]=n=>e.value.unit=n),class:"input input-bordered w-full",type:"text",placeholder:"\u8ACB\u8F38\u5165\u7522\u54C1\u55AE\u4F4D\u2026\u2026",required:""},null,512),[[p,e.value.unit]])])])]),t("div",Qt,[t("div",jt,[Lt,t("div",Bt,[u(t("input",{id:"originalPrice","onUpdate:modelValue":l[6]||(l[6]=n=>e.value.origin_price=n),class:"input input-bordered w-full",type:"number",placeholder:"\u8ACB\u8F38\u5165\u539F\u50F9\u2026\u2026",min:"1",required:""},null,512),[[p,e.value.origin_price,void 0,{number:!0}]]),St])]),t("div",Et,[Wt,t("div",zt,[u(t("input",{id:"price","onUpdate:modelValue":l[7]||(l[7]=n=>e.value.price=n),class:"input input-bordered w-full",type:"number",placeholder:"\u8ACB\u8F38\u5165\u552E\u50F9\u2026\u2026",min:"1",required:""},null,512),[[p,e.value.price,void 0,{number:!0}]]),Nt])])]),t("div",Ot,[Tt,u(t("textarea",{id:"description","onUpdate:modelValue":l[8]||(l[8]=n=>e.value.description=n),class:"textarea input-bordered",placeholder:"\u8ACB\u8F38\u5165\u7522\u54C1\u63CF\u8FF0\u2026\u2026"},null,512),[[p,e.value.description]])]),t("div",Gt,[Jt,u(t("textarea",{id:"content","onUpdate:modelValue":l[9]||(l[9]=n=>e.value.content=n),class:"textarea input-bordered",placeholder:"\u8ACB\u8F38\u5165\u7522\u54C1\u8AAA\u660E\u5167\u5BB9\u2026\u2026"},null,512),[[p,e.value.content]])]),t("div",Kt,[t("label",Rt,[Xt,u(t("input",{id:"isEnabled","onUpdate:modelValue":l[10]||(l[10]=n=>e.value.is_enabled=n),class:"toggle toggle-success",type:"checkbox","true-value":1,"false-value":0},null,512),[[B,e.value.is_enabled]])])])])],40,T),t("div",Yt,[te,t("button",{class:"btn",onClick:n=>c()},"\u53D6\u6D88",8,ee)])])]),_:3},16)}}}),se={class:"flex justify-between w-full mb-8"},oe=t("h1",{class:"text-4xl font-bold"},"\u5F8C\u53F0\u7522\u54C1\u8CC7\u8A0A",-1),ne={class:"overflow-x-auto w-full"},ae={class:"table table-zebra w-full"},ie=t("thead",{class:"sticky top-0 z-20"},[t("tr",null,[t("th",null,"\u7D22\u5F15"),t("th",null,"\u9996\u5716"),t("th",null,"\u540D\u7A31"),t("th",null,"\u5206\u985E"),t("th",null,"\u539F\u50F9 / \u552E\u50F9"),t("th",null,"\u662F\u5426\u555F\u7528"),t("th",null,"\u7DE8\u8F2F")])],-1),re=["src","alt"],de={key:0,class:"text-success"},ue={key:1,class:"text-warning"},ce={class:"btn-group"},pe=["onClick"],he=t("svg",{title:"\u7DE8\u8F2F",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",height:"24",width:"24"},[t("path",{d:"M5 19h1.4l8.625-8.625-1.4-1.4L5 17.6ZM19.3 8.925l-4.25-4.2 1.4-1.4q.575-.575 1.413-.575.837 0 1.412.575l1.4 1.4q.575.575.6 1.388.025.812-.55 1.387ZM17.85 10.4 7.25 21H3v-4.25l10.6-10.6Zm-3.525-.725-.7-.7 1.4 1.4Z"})],-1),me=[he],_e=["onClick"],fe=t("svg",{title:"\u522A\u9664",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",height:"24",width:"24"},[t("path",{d:"M7 21q-.825 0-1.412-.587Q5 19.825 5 19V6H4V4h5V3h6v1h5v2h-1v13q0 .825-.587 1.413Q17.825 21 17 21ZM17 6H7v13h10ZM9 17h2V8H9Zm4 0h2V8h-2ZM7 6v13Z"})],-1),be=[fe],xe={__name:"dashboardProducts",setup(q){const m=M("axiosWithAuth"),w=M("$loading"),_=b([]),e=b({});async function d(s=1){const l=w.show();m({method:"get",url:`https://vue3-course-api.hexschool.io/api/riceball/admin/products/?page=${s}`}).then(o=>{_.value=o.data.products,e.value=o.data.pagination}).finally(()=>{l.hide()})}function h(s){d(s)}function x(s){m({method:"post",url:"https://vue3-course-api.hexschool.io/api/riceball/admin/product",data:{...s}}).then(()=>{d()})}function y(){V.show({component:F,on:{confirm(s){const l={data:{...s}};x(l)}},slots:{title:"\u65B0\u589E\u7522\u54C1"}})}function U(s){m({method:"put",url:`/admin/product/${s.data.id}`,data:{...s}}).then(()=>{d()})}function $(s){V.show({component:F,bind:{product:{...s}},on:{confirm(l){const o={data:{...l}};U(o)}},slots:{title:"\u7DE8\u8F2F\u7522\u54C1"}})}function k(s){m({method:"delete",url:`/admin/product/${s}`}).then(()=>{d()})}function C(s){V.show({component:W,bind:{dashboardItem:{...s}},on:{confirm(){k(s.id)}},slots:{title:"\u522A\u9664\u7522\u54C1"}})}return d(),(s,l)=>(a(),i(g,null,[t("div",se,[oe,t("button",{class:"btn btn-primary",type:"button",onClick:l[0]||(l[0]=o=>y())},"\u65B0\u589E\u7522\u54C1")]),t("div",ne,[t("table",ae,[ie,t("tbody",null,[(a(!0),i(g,null,P(_.value,(o,c)=>(a(),i("tr",{key:o.key},[t("th",null,f(e.value.current_page===1?c+1:c+1+e.value.current_page*10-10),1),t("td",null,[t("img",{width:"150",src:o.imageUrl,alt:o.title},null,8,re)]),t("td",null,f(o.title),1),t("td",null,f(o.category),1),t("td",null,f(s.$unitFilters.currency(o.origin_price))+" \u5143 / "+f(s.$unitFilters.currency(o.price))+" \u5143",1),t("td",null,[o.is_enabled?(a(),i("span",de,"\u555F\u7528")):(a(),i("span",ue,"\u672A\u555F\u7528"))]),t("td",null,[t("div",ce,[t("button",{class:"btn btn-outline btn-square",onClick:n=>$(o)},me,8,pe),t("button",{class:"btn btn-outline btn-square hover:btn-error -ml-px",onClick:n=>C(o)},be,8,_e)])])]))),128))])])]),E(z,{pages:e.value,onPaginationChange:h},null,8,["pages"])],64))}};export{xe as default};
